@model IEnumerable<CW_COMP_1471.Models.Play>

@{
    ViewData["Title"] = "Available Plays";
}

<h2 class="text-center mb-4">Available Plays</h2>

<div class="container">
    <div class="row">
        @foreach (var play in Model)
        {
            <div class="col-md-4 mb-4">
                <div class="card shadow-lg h-100">
                    <div class="card-body">
                        <h5 class="card-title">@play.Title</h5>
                        <h6 class="card-subtitle text-muted">@play.Genre</h6>
                        <p class="card-text mt-2">@play.Description</p>
                        <p><strong>Date & Time:</strong> @play.Dateandtime.ToString("dd-MM-yyyy hh:mm tt")</p>
                        <p><strong>Play Type:</strong> @play.Playtype</p>
                        
                        <div class="form-group">
                            <label for="pricingBand-@play.Playid"><strong>Pricing Band</strong></label>
                            <select id="pricingBand-@play.Playid" class="form-control">
                                <option value="Economy">Economy</option>
                                <option value="Standard">Standard</option>
                                <option value="Premium">Premium</option>
                            </select>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <div class="input-group" style="width: 120px;">
                                <button class="btn btn-outline-secondary" type="button" onclick="decrement(@play.Playid)">-</button>
                                <input type="text" id="ticketCount-@play.Playid" class="form-control text-center" value="1" readonly />
                                <button class="btn btn-outline-secondary" type="button" onclick="increment(@play.Playid)">+</button>
                            </div>
                            <button class="btn btn-primary" onclick="addToCart(@play.Playid)">Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<script>
    function increment(playId) {
        var input = document.getElementById("ticketCount-" + playId);
        var value = parseInt(input.value);
        if (value < 10) { // Limit max tickets to 10
            input.value = value + 1;
        }
    }

    function decrement(playId) {
        var input = document.getElementById("ticketCount-" + playId);
        var value = parseInt(input.value);
        if (value > 1) { // Prevent going below 1
            input.value = value - 1;
        }
    }

    function addToCart(playId) {
        var count = document.getElementById("ticketCount-" + playId).value;
        var pricingBand = document.getElementById("pricingBand-" + playId).value;

        // Send data to the server (can be integrated with AJAX for real-time cart updates)
        alert(`Added ${count} tickets for Play ID ${playId} with ${pricingBand} pricing to cart!`);
    }
</script>
